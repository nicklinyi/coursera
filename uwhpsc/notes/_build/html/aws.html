<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Amazon Web Services EC2 AMI [2014 version] &mdash; AMath 483/583, Spring 2013 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="AMath 483/583, Spring 2013 1.0 documentation" href="index.html" />
    <link rel="next" title="Software Carpentry" href="software_carpentry.html" />
    <link rel="prev" title="Virtual Machine for this class [2014 Edition]" href="vm.html" /> 
  </head>
  <body role="document">

<div style="background-color: #F0D576; text-align: left; padding: 10px 10px 15px 15px">
<table>
<tr>
<td>
<a href="http://www.amath.washington.edu/"><img src="_static/uwamath.gif" border="0" alt="UW AMath"/></a>
</td>
<td>
<font size=5> High Performance Scientific Computing</font>
<br>&nbsp;<br>
<font size=5> AMath 483/583 Class Notes</font>
<br>&nbsp;<br>
<font size=5> Spring Quarter, 2013 </font>
</td>
</tr>
</table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="software_carpentry.html" title="Software Carpentry"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="vm.html" title="Virtual Machine for this class [2014 Edition]"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html"><font color="#39275b">Contents</font></a>|&nbsp;</li>
        <li><a href="biblio.html"><font color="#39275b">Bibliography</font></a>|&nbsp;</li>
        <li><a href="search.html"><font color="#39275b">Search</font></a>|&nbsp;</li>
        <li><a href="http://faculty.washington.edu/rjl/classes/am583s2014/index.html"><font color="#39275b">Class Webpage</font></a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Amazon Web Services EC2 AMI [2014 version]</a><ul>
<li><a class="reference internal" href="#launching-an-instance-with-the-uwhpsc-ami">Launching an instance with the <em>uwhpsc</em> AMI</a><ul>
<li><a class="reference internal" href="#quick-way">Quick way</a></li>
<li><a class="reference internal" href="#search-for-ami">Search for AMI</a></li>
<li><a class="reference internal" href="#choose-instance-type">Choose instance type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#launch-instance-create-key-pair">Launch instance / create key pair</a></li>
<li><a class="reference internal" href="#logging-on-to-your-instance">Logging on to your instance</a></li>
<li><a class="reference internal" href="#transferring-files-to-from-your-instance">Transferring files to/from your instance</a></li>
<li><a class="reference internal" href="#stopping-your-instance">Stopping your instance</a></li>
<li><a class="reference internal" href="#creating-your-own-ami">Creating your own AMI</a></li>
<li><a class="reference internal" href="#viewing-webpages-directly-from-your-instance">Viewing webpages directly from your instance</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="vm.html"
                        title="previous chapter">Virtual Machine for this class [2014 Edition]</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="software_carpentry.html"
                        title="next chapter">Software Carpentry</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/aws.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="amazon-web-services-ec2-ami-2014-version">
<span id="aws"></span><h1>Amazon Web Services EC2 AMI [2014 version]<a class="headerlink" href="#amazon-web-services-ec2-ami-2014-version" title="Permalink to this headline">¶</a></h1>
<p>We are using a wide variety of software in this class, much of which is
probably not found on your computer.  It is all open source software (see
<span class="xref std std-ref">licences</span>) and links/instructions
can be found in the section <a class="reference internal" href="software_installation.html#software-installation"><span class="std std-ref">Downloading and installing software for this class</span></a>.
You can also use the <a class="reference internal" href="vm.html#vm"><span class="std std-ref">Virtual Machine for this class [2014 Edition]</span></a>.</p>
<p>Another alternative is to write and run your programs &#8220;in the cloud&#8221;
using Amazon Web Services (AWS) Elastic Cloud Computing (EC2).
You can start up an &#8220;instance&#8221; (your own private computer, or so it appears)
that is configured using an Amazon Machine Image (AMI) that has been
configured with the Linux operating system and containing
all the software needed for this class.</p>
<p>You must first sign up for an account  on the <a class="reference external" href="http://aws.amazon.com/">AWS main page</a>.  For this you will need a credit
card, but note that with an account you can get 750 hours per month of
free &#8220;micro instance&#8221; usage in the
<a class="reference external" href="http://aws.amazon.com/free/">free usage tier</a>.
A micro instance is a single processor (that you will probably be sharing
with others) so it&#8217;s not suitable for trying out parallel computing, but
should be just fine for much of the programming work in this class.</p>
<p>You can start up more powerful instances with 2 or more processors for a cost
starting at less than 3 cents per hour (the m3.large on-demand
instance).  See the <a class="reference external" href="http://aws.amazon.com/ec2/pricing/">pricing guide</a>.</p>
<p>For general information and guides to getting started:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.amazonwebservices.com/AWSEC2/latest/GettingStartedGuide/">Getting started with EC2</a>,
with tutorial to lead you through an example.</li>
<li><a class="reference external" href="http://aws.amazon.com/ec2/faqs">EC2 FAQ</a>.</li>
<li><a class="reference external" href="http://aws.amazon.com/ec2/pricing">Pricing</a>.  Note: you are charged
per hour for hours (or fraction thereof) that your instance is in
<cite>running</cite> mode, regardless of whether the CPU is being used.</li>
<li><a class="reference external" href="http://aws.amazon.com/hpc-applications/">High Performance Computing on AWS</a>
with instructions on starting a cluster instance.</li>
<li><a class="reference external" href="http://escience.washington.edu/get-help-now/get-started-amazon-web-services">UW eScience information on AWS</a>.</li>
</ul>
<div class="section" id="launching-an-instance-with-the-uwhpsc-ami">
<h2>Launching an instance with the <em>uwhpsc</em> AMI<a class="headerlink" href="#launching-an-instance-with-the-uwhpsc-ami" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quick-way">
<h3>Quick way<a class="headerlink" href="#quick-way" title="Permalink to this headline">¶</a></h3>
<p>Navigate your browser to
<a class="reference external" href="https://console.aws.amazon.com/ec2/home?region=us-west-2#launchAmi=ami-501a7260">https://console.aws.amazon.com/ec2/home?region=us-west-2#launchAmi=ami-501a7260</a></p>
<p>You should then be on a page where you see you are on Step 2 of 7 at the top
of the page, &#8220;Choose instance type&#8221;.</p>
<p>Then you can skip the next section and proceed to <a class="reference internal" href="#aws-instance-type"><span class="std std-ref">Choose instance type</span></a>.</p>
</div>
<div class="section" id="search-for-ami">
<h3>Search for AMI<a class="headerlink" href="#search-for-ami" title="Permalink to this headline">¶</a></h3>
<p><strong>Skip this section</strong> if you followed the &#8220;quick way&#8221; instructions above.</p>
<p>Going through this part may be useful if you want to see how to search for
other AMI&#8217;s in the future.</p>
<p>Once you have an AWS account, sign in to the
<a class="reference external" href="https://console.aws.amazon.com/ec2/">management console</a>
and click on the
EC2 tab, and then select Region US West (Oregon) from the menu
at the top right of the page, next to your user name.</p>
<p>You should now be on the page
<a class="reference external" href="https://console.aws.amazon.com/ec2/v2/home?region=us-west-2">https://console.aws.amazon.com/ec2/v2/home?region=us-west-2</a>.</p>
<p>Click on the big &#8220;Launch Instance&#8221; button.</p>
<p>On the next page, you will see a list of &#8220;Quick start&#8221;
Amazon Machine Images (AMIs) that
you can select from if you want to start with a fresh VM.  For this class
you don&#8217;t want any of these.  Instead click on the &#8220;Community AMIs&#8221; tab and
then type <cite>uwhpsc2014</cite> in the search bar.  Select this image.</p>
<p>You will then be taken to Step 2, &#8220;Choose instance type&#8221;.</p>
</div>
<div class="section" id="choose-instance-type">
<span id="aws-instance-type"></span><h3>Choose instance type<a class="headerlink" href="#choose-instance-type" title="Permalink to this headline">¶</a></h3>
<p>On the next page you can select what sort of instance you wish to start (larger
instances cost more per hour). t1-micro is the the size you can run free (as
long as you only have one running).</p>
<p>Click <cite>Continue</cite> on the next few screens through the &#8220;instance details&#8221;
and eventually you get to one that
asks for a key pair.  If you don&#8217;t already have one, create a new one and
select it here.</p>
<p>You can now skip over steps 3-6 and jump directly to Step 7, &#8220;Review and
Launch&#8221;.</p>
</div>
</div>
<div class="section" id="launch-instance-create-key-pair">
<h2>Launch instance / create key pair<a class="headerlink" href="#launch-instance-create-key-pair" title="Permalink to this headline">¶</a></h2>
<p>When you click on &#8220;Launch&#8221;, you will get a page that asks you to &#8220;Select and
existing key pair or create a new one&#8221;.  If you don&#8217;t already have a key
pair, select &#8220;Create a new pair&#8221; from the menu and follow instructions.  If
you give the name <cite>mykey</cite>, for example, then this will download a file
<cite>mykey.pem</cite>.   Store this file in a directory where you can find it again,
since you will need this key in order to log in to your instance once it is
running.</p>
<p>You also need to change the permissions on this file so that is readable only
by the account user.  In the directory where this file lives, give the
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">chmod</span> <span class="mi">400</span> <span class="n">mykey</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
<p>If the file is more widely readable then you will not be able to use this
key to log into your instance.</p>
</div>
<div class="section" id="logging-on-to-your-instance">
<h2>Logging on to your instance<a class="headerlink" href="#logging-on-to-your-instance" title="Permalink to this headline">¶</a></h2>
<p>Click <cite>View Instances</cite> on the  page that appears to
go back to the Management Console.  Click on <cite>Instances</cite> on the left menu
and you should see a list of instance you
have created, in your case only one.  If the status is not yet <cite>running</cite>
then wait until it is (click on the <cite>Refresh</cite> button if necessary).</p>
<p><em>Click on the instance</em> and information about it should appear at the bottom
of the screen. Scroll down until you find the <cite>Public DNS</cite> information</p>
<p>Go into the directory where your key pair is stored, in a file with a name
like <cite>mykey.pem</cite> and you should be able to <cite>ssh</cite> into your instance using
the name of the public DNS, with format like:</p>
<div class="highlight-default"><div class="highlight"><pre>$ ssh -Y -i KEYPAIR-FILE  ubuntu@DNS
</pre></div>
</div>
<p>where KEYPAIR-FILE and DNS must be replaced by the appropriate
things, e.g. something like this:</p>
<div class="highlight-default"><div class="highlight"><pre>$ ssh -Y -i mykey.pem ubuntu@ec2-50-19-75-229.compute-1.amazonaws.com
</pre></div>
</div>
<p>Note:</p>
<ul class="simple">
<li>You must include <cite>-i keypair-file</cite></li>
<li>You must log in as user ubuntu.</li>
<li>Including -Y in the ssh command allows X window forwarding, so that if you
give a command that opens a new window (e.g. plotting in Python) it will
appear on your local screen.</li>
<li>See the section <a class="reference internal" href="ssh.html#ssh"><span class="std std-ref">Using ssh to connect to remote computers</span></a> for tips if you are using a Mac or Windows
machine.
If you use Windows, see also the Amazon notes on using <em>putty</em> found at
<a class="reference external" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html">http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html</a>.</li>
</ul>
<p>Once you have logged into your instance, you are on Ubuntu Linux that has
software needed for this class pre-installed.  See the file <cite>install.sh</cite> in
the running instance to see the commands that were used to install software.</p>
<p>Other software is easily installed using <cite>apt-get install</cite>, as described
in <a class="reference internal" href="software_installation.html#software-installation"><span class="std std-ref">Downloading and installing software for this class</span></a>.</p>
</div>
<div class="section" id="transferring-files-to-from-your-instance">
<h2>Transferring files to/from your instance<a class="headerlink" href="#transferring-files-to-from-your-instance" title="Permalink to this headline">¶</a></h2>
<p>You can use <cite>scp</cite> to transfer files between a running instance and
the computer on which the ssh key is stored.</p>
<p>From your computer (not from the instance):</p>
<div class="highlight-default"><div class="highlight"><pre>$ scp -i KEYPAIR-FILE FILE-TO-SEND ubuntu@DNS:REMOTE-DIRECTORY
</pre></div>
</div>
<p>where DNS is the public DNS of the instance and <cite>REMOTE-DIRECTORY</cite> is
the path (relative to home directory)
where you want the file to end up.  You can leave off
<cite>:REMOTE-DIRECTORY</cite> if you want it to end up in your home directory.</p>
<p>Going the other way, you can download a file from your instance to
your own computer via:</p>
<div class="highlight-default"><div class="highlight"><pre>$ scp -i KEYPAIR-FILE ubuntu@DNS:FILE-TO-GET .
</pre></div>
</div>
<p>to retrieve the file named <cite>FILE-TO-GET</cite> (which might include a path
relative to the home directory) into the current directory.</p>
</div>
<div class="section" id="stopping-your-instance">
<h2>Stopping your instance<a class="headerlink" href="#stopping-your-instance" title="Permalink to this headline">¶</a></h2>
<p>Once you are done computing for the day, you will probably want to stop your
instance so you won&#8217;t be charged while it&#8217;s sitting idle.  You can do this
by selecting the instance from the Management Console / Instances, and then
select <cite>Stop</cite> from the <cite>Instance Actions</cite> menu.</p>
<p>You can restart it later and it will be in the same state you left it in.
But note that it will probably have a new Public DNS!</p>
</div>
<div class="section" id="creating-your-own-ami">
<h2>Creating your own AMI<a class="headerlink" href="#creating-your-own-ami" title="Permalink to this headline">¶</a></h2>
<p>If you add additional software and want to save a disk image of your
improved virtual machine (e.g. in order to launch additional images in the
future to run multiple jobs at once), simply click on <cite>Create Image (EBS
AMI)</cite> from the <cite>Instance Actions</cite> menu.</p>
</div>
<div class="section" id="viewing-webpages-directly-from-your-instance">
<h2>Viewing webpages directly from your instance<a class="headerlink" href="#viewing-webpages-directly-from-your-instance" title="Permalink to this headline">¶</a></h2>
<p>An apache webserver should already be running in your instance,
but to allow people (including yourself) to view
webpages you will need to adjust the security settings.  Go back to the
Management Console and click on <cite>Security Groups</cite> on the left menu.  Select
<cite>launch-wizard-1</cite> and then click on <cite>Inbound</cite>.  Click on <cite>+Add rule</cite>.
You should see a list of ports
that only lists 22 (SSH).  You want to add port 80 (HTTP).  Select HTTP from
the drop-down menu that says <cite>Custom TCP Rule</cite> and then click on <cite>+Add rule</cite>
and <cite>Apply Rule Change</cite>.</p>
<p>Now you should be able to point your browser to <cite>http://DNS</cite> where <cite>DNS</cite> is
replaced by the Public DNS name of your instance, the same as used for the
<cite>ssh</cite> command.  So for the example above, this would be</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ec2</span><span class="o">-</span><span class="mi">50</span><span class="o">-</span><span class="mi">19</span><span class="o">-</span><span class="mi">75</span><span class="o">-</span><span class="mf">229.</span><span class="n">compute</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>The page being displayed can be found in <cite>/var/www/index.html</cite> on your
instance.  Any files you want to be visible on the web should be in
<cite>/var/www</cite>, or it is sufficient to have a link from this directory to where
they are located (created with the <cite>ln -s</cite> command in linux).</p>
<p>So, for example, you could do the following (this has already been done if
you start with the uwhpsc2104 AMI):</p>
<div class="highlight-default"><div class="highlight"><pre>$ cd $HOME
$ mkdir public      # create a directory for posting things
$ chmod 755 public  # make it readable by others
$ sudo ln -s $HOME/public /var/www/public
</pre></div>
</div>
<p>then you can see the contents of your $HOME/public directory at:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ec2</span><span class="o">-</span><span class="mi">50</span><span class="o">-</span><span class="mi">19</span><span class="o">-</span><span class="mi">75</span><span class="o">-</span><span class="mf">229.</span><span class="n">compute</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">public</span>
</pre></div>
</div>
<p>Remember to change the DNS above to the right thing for your own instance!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="software_carpentry.html" title="Software Carpentry"
             >next</a> |</li>
        <li class="right" >
          <a href="vm.html" title="Virtual Machine for this class [2014 Edition]"
             >previous</a> |</li>
        <li><a href="index.html"><font color="#39275b">Contents</font></a>|&nbsp;</li>
        <li><a href="biblio.html"><font color="#39275b">Bibliography</font></a>|&nbsp;</li>
        <li><a href="search.html"><font color="#39275b">Search</font></a>|&nbsp;</li>
        <li><a href="http://faculty.washington.edu/rjl/classes/am583s2014/index.html"><font color="#39275b">Class Webpage</font></a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Randall J. LeVeque, CC BY.
      Last updated on May 19, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>