<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Numerics in Python &mdash; AMath 483/583, Spring 2013 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="AMath 483/583, Spring 2013 1.0 documentation" href="index.html" />
    <link rel="next" title="IPython_notebook" href="ipython_notebook.html" />
    <link rel="prev" title="Python strings" href="python_strings.html" /> 
  </head>
  <body role="document">

<div style="background-color: #F0D576; text-align: left; padding: 10px 10px 15px 15px">
<table>
<tr>
<td>
<a href="http://www.amath.washington.edu/"><img src="_static/uwamath.gif" border="0" alt="UW AMath"/></a>
</td>
<td>
<font size=5> High Performance Scientific Computing</font>
<br>&nbsp;<br>
<font size=5> AMath 483/583 Class Notes</font>
<br>&nbsp;<br>
<font size=5> Spring Quarter, 2013 </font>
</td>
</tr>
</table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ipython_notebook.html" title="IPython_notebook"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="python_strings.html" title="Python strings"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html"><font color="#39275b">Contents</font></a>|&nbsp;</li>
        <li><a href="biblio.html"><font color="#39275b">Bibliography</font></a>|&nbsp;</li>
        <li><a href="search.html"><font color="#39275b">Search</font></a>|&nbsp;</li>
        <li><a href="http://faculty.washington.edu/rjl/classes/am583s2014/index.html"><font color="#39275b">Class Webpage</font></a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Numerics in Python</a><ul>
<li><a class="reference internal" href="#vectors-and-matrices">Vectors and Matrices</a></li>
<li><a class="reference internal" href="#component-wise-operations">Component-wise operations</a></li>
<li><a class="reference internal" href="#further-reading">Further reading</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="python_strings.html"
                        title="previous chapter">Python strings</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ipython_notebook.html"
                        title="next chapter">IPython_notebook</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/numerical_python.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="numerics-in-python">
<span id="numerical-python"></span><h1>Numerics in Python<a class="headerlink" href="#numerics-in-python" title="Permalink to this headline">¶</a></h1>
<p>Python is a general programming language and is used for many purposes that have
nothing to do with scientific computing or numerical methods.  However,
there are a number of modules that can be imported that provide a variety of
numerical methods and other tools that are very useful for scientific
computing.</p>
<p>The basic module needed for most numerical work is <em>NumPy</em>, which provides in
particular the data structures needed for working with
arrays of real numbers representing vectors or matrices.  The module <em>SciPy</em>
provides additional numerical methods and tools.</p>
<p>If you know Matlab, you will find that many of the things you are used to
doing in that language can be done using <em>NumPy</em> and <em>SciPy</em>, although the
syntax is often a bit different.  Matlab users will find web page
<a class="reference internal" href="biblio.html#numpy-for-matlab-users" id="id1">[NumPy-for-Matlab-Users]</a> crucial for understanding the differences and
transitioning to Python, and this page is useful for all new users.  A
tutorial can be found at <a class="reference internal" href="biblio.html#numpy-tutorial" id="id2">[NumPy-tutorial]</a>.</p>
<div class="section" id="vectors-and-matrices">
<h2>Vectors and Matrices<a class="headerlink" href="#vectors-and-matrices" title="Permalink to this headline">¶</a></h2>
<p>Python has lists as a built-in data type, e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>
</pre></div>
</div>
<p>defines a list that contains 3 real numbers and might be viewed as a vector.
However, you cannot easily do arithmetic on such lists the way you can with
vectors in Matlab, e.g.  2*x does not give [2., 4., 6.] as you might hope:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="go">[1.0, 2.0, 3.0, 1.0, 2.0, 3.0]</span>
</pre></div>
</div>
<p>instead it doubles the length of <em>x</em>, and <em>x+x</em> would give the same thing.
You also cannot apply <em>sqrt</em> to a list to get a new list containing the
square root of each element, for example.</p>
<p>Two-dimensional arrays are also a bit clumsy in Python, as they have to be
specified as a list of lists, e.g. a 3x2 array with the elements 11,12 in
the first row, 21,22 in the second row, 31,32 in the third row would be
specified by:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">]]</span>
</pre></div>
</div>
<p>Note that indexing always starts with 0 in Python, so we find for example
that:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[11, 12]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[21, 22]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">21</span>
</pre></div>
</div>
<p>Here A[0] refers to the 0-index element of A, which is itself a list [11, 12].
and A[1][0] can be understood as the 0-index element of A[1] = [21, 22].</p>
<p>You cannot work with A as a matrix, for example to multiply it by a vector,
except by writing code that loops over the elements explicitly.</p>
<p>NumPy was developed to make it easy to do the sorts of things we want to do
with matrices and vectors, and more generally n-dimensional arrays of real
numbers.</p>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([ 1.,  2.,  3.])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="go">array([ 2.,  4.,  6.])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([ 1.        ,  1.41421356,  1.73205081])</span>
</pre></div>
</div>
<p>We see that we can multiply by a scalar or take component-wise square roots.</p>
<p>You may find it ugly to have to start numpy command with np., as necessary
here since we imported numpy as np. Instead you could do:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>and then just use <em>sqrt</em>, for example, and you will get the NumPy version.
But in these notes and many Python examples you&#8217;ll see, the module is
explicitly listed so it is clear where a function is coming from.</p>
<p>For matrices, we can convert our list of lists into a <em>NumPy</em> array as
follows (we specify <em>dtype=float</em> to make sure the elements of A are stored
as floating point real number even though we type them here as integers):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">array([[ 11.,  12.],</span>
<span class="go">       [ 21.,  22.],</span>
<span class="go">       [ 31.,  32.]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">12.</span>
</pre></div>
</div>
<p>Note that we can now index into the array as in matrix notation A[0,1]
(remembering that indexing starts at 0 in Python), so this the [0,1]
element of A means the first row and second column.</p>
<p>We can also do slicing operations, extracting a single row or column:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="go">array([11., 12.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([11., 21., 31.])</span>
</pre></div>
</div>
<p>Since A is a NumPy array object, there are certain methods automatically
defined on A, such as the transpose:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[11., 21., 31.],</span>
<span class="go">       [12., 22., 32.]])</span>
</pre></div>
</div>
<p>Seeing all the methods defined for A is easy if you use the IPython shell
(see <span class="xref std std-ref">ipython</span>), just type A. followed by the tab key (you will find
there are 155 methods defined).</p>
<p>We can do matrix-vector or matrix-matrix multiplication using the NumPy dot
function:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">array([ 146.,  152.])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">array([[1523., 1586.],</span>
<span class="go">       [1586., 1652.]])</span>
</pre></div>
</div>
<p>This looks somewhat less mathematical than Matlab notation A&#8217;<a href="#id3"><span class="problematic" id="id4">*</span></a>A, but the syntax
and data structures of Matlab were designed specifically for linear algebra,
whereas Python is a more general language and so doing linear algebra has to
be done in this framework.</p>
<p>Note that elements of a <em>NumPy</em> array are always all of the same type, and
generally we want <em>floats</em>, though integer arrays can also be defined.
This is different than Python lists, which can contain elements with
different types, e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="s">&#39;xyz&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">&lt;type &#39;int&#39;&gt; &lt;type &#39;float&#39;&gt; &lt;type &#39;str&#39;&gt; &lt;type &#39;list&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="component-wise-operations">
<h2>Component-wise operations<a class="headerlink" href="#component-wise-operations" title="Permalink to this headline">¶</a></h2>
<p>One thing to watch out for if you are used to Matlab notation:  In Matlab
some operations (such as sqrt, sin, cos, exp, etc) can be applied to vectors
or matrices and will automatically be applied component-wise.  Other
operations like * and / (multiplication and division) attempt to do things
in terms of linear algebra, and so in Matlab, A*B gives the matrix product
and only makes sense if the number of columns of A agrees with the number of
rows of B.  If you want a component-wise product of A and B you must use .*
instead, with a period before the <a href="#id5"><span class="problematic" id="id6">*</span></a>.</p>
<p>In NumPy,  * and / are applied component-wise, like any other operation.  To
get a matrix-product you must use <em>dot</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [3, 4]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span>
<span class="go">array([[5, 0],</span>
<span class="go">       [0, 7]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">*</span><span class="n">B</span>
<span class="go">array([[ 5,  0],</span>
<span class="go">       [ 0, 28]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="go">array([[ 5, 14],</span>
<span class="go">       [15, 28]])</span>
</pre></div>
</div>
<p>Many other linear algebra tools can be found in <em>NumPy</em>.  For example, to
solve a linear system Ax = b using Gaussian Elimination, we can do:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [3, 4]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([-1. ,  1.5])</span>
</pre></div>
</div>
<p>To find the eigenvalues and eigenvectors of A:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">evals</span>
<span class="go">array([-0.37228132,  5.37228132])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">evecs</span>
<span class="go">array([[-0.82456484, -0.41597356],</span>
<span class="go">       [ 0.56576746, -0.90937671]])</span>
</pre></div>
</div>
<p>Note: You may be tempted to use the variable name <em>lambda</em> for the eigenvalues
of a matrix, but this isn&#8217;t allowed in Python because <em>lambda</em> is a keyword
of the language, see <a class="reference internal" href="python_functions.html#lambda-functions"><span class="std std-ref">Lambda functions</span></a>.</p>
</div>
<div class="section" id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p>Be sure to visit</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://www.scipy.org/Tentative_NumPy_Tutorial">http://www.scipy.org/Tentative_NumPy_Tutorial</a></li>
<li><a class="reference external" href="http://www.scipy.org/NumPy_for_Matlab_Users">http://www.scipy.org/NumPy_for_Matlab_Users</a></li>
</ul>
</div></blockquote>
<p>See also <a class="reference internal" href="biblio.html#numpy-pros-cons" id="id7">[NumPy-pros-cons]</a> for more about differences with other
mathematical languages.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ipython_notebook.html" title="IPython_notebook"
             >next</a> |</li>
        <li class="right" >
          <a href="python_strings.html" title="Python strings"
             >previous</a> |</li>
        <li><a href="index.html"><font color="#39275b">Contents</font></a>|&nbsp;</li>
        <li><a href="biblio.html"><font color="#39275b">Bibliography</font></a>|&nbsp;</li>
        <li><a href="search.html"><font color="#39275b">Search</font></a>|&nbsp;</li>
        <li><a href="http://faculty.washington.edu/rjl/classes/am583s2014/index.html"><font color="#39275b">Class Webpage</font></a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Randall J. LeVeque, CC BY.
      Last updated on May 19, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>